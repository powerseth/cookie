<!DOCTYPE html>
<html lang="ru">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
  <title>üö¨ Vape 9000 üõ∏</title>
  <style>
    /* (CSS styles unchanged, already applied above) */
  </style>
</head>
<body>
  <div class="screen active" id="screen-choose">
    <div class="welcome-screen">
      üö¨ Vape 9000 üõ∏ <br> –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ –º–∏—Ä –≤–∫—É—Å–∞
    </div>
    <div class="filters">
      <select id="nicotine">
        <option value="all">–ö—Ä–µ–ø–æ—Å—Ç—å</option>
        <option value="2%">2%</option>
        <option value="2.5%">2.5%</option>
        <option value="5%">5%</option>
        <option value="6%">6%</option>
      </select>
      <select id="puffs">
        <option value="all">–ó–∞—Ç—è–∂–∫–∏</option>
        <option value="10000">–î–æ 10k</option>
        <option value="20000">10k-20k</option>
        <option value="30000">20k-30k</option>
        <option value="40000">40k+</option>
      </select>
      <select id="price">
        <option value="all">–¶–µ–Ω–∞</option>
        <option value="10">‚Ç¨10-‚Ç¨20</option>
        <option value="20">‚Ç¨20-‚Ç¨30</option>
        <option value="30">‚Ç¨30+</option>
      </select>
    </div>
    <div class="product-list" id="product-list">
      <div class="shimmer"></div>
      <div class="shimmer"></div>
      <div class="shimmer"></div>
    </div>
    <button class="bottom-button" onclick="goToCart()">–ö–æ—Ä–∑–∏–Ω–∞ –∏ –æ—Ñ–æ—Ä–º–ª–µ–Ω–∏–µ</button>
  </div>

  <div class="screen" id="screen-cart">
    <h2>üõí –ö–æ—Ä–∑–∏–Ω–∞</h2>
    <div id="cart-items"></div>
    <div class="cart-summary">–°—É–º–º–∞: ‚Ç¨<span id="cart-total">0</span></div>
    <div class="finish-buttons">
      <button onclick="goToChoose()">‚Üê –ù–∞–∑–∞–¥</button>
      <button onclick="goToFinish()">–ü—Ä–æ–¥–æ–ª–∂–∏—Ç—å ‚Üí</button>
    </div>
  </div>

  <div class="screen" id="screen-finish">
    <h2>–ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ</h2>
    <div class="finish-buttons">
      <button onclick="sendToStas()">üì§ –û—Ç–ø—Ä–∞–≤–∏—Ç—å –°—Ç–∞—Å—É</button>
      <button onclick="goToCart()">‚Üê –ù–∞–∑–∞–¥</button>
      <button onclick="goToChannel()">üì£ –ü–µ—Ä–µ–π—Ç–∏ –≤ –∫–∞–Ω–∞–ª</button>
    </div>
  </div>

  <script>
    let products = [];
    let cart = [];

    async function loadProducts() {
      const list = document.getElementById('product-list');
      list.innerHTML = '<div class="shimmer"></div><div class="shimmer"></div><div class="shimmer"></div>';
      try {
        const res = await fetch('vapes.json');
        products = await res.json();
        filterProducts();
      } catch (err) {
        list.innerHTML = '<p style="color: red">–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ç–æ–≤–∞—Ä–æ–≤ üò¢</p>';
      }
    }

    function filterProducts() {
      const nic = document.getElementById('nicotine').value;
      const puf = document.getElementById('puffs').value;
      const pri = document.getElementById('price').value;

      const filtered = products.filter(p => {
        return (nic === 'all' || p.nicotine === nic) &&
               (puf === 'all' || p.puffs >= parseInt(puf)) &&
               (pri === 'all' || p.price <= parseInt(pri));
      });

      displayProducts(filtered);
    }

    function displayProducts(list) {
      const container = document.getElementById('product-list');
      container.innerHTML = '';
      list.forEach(p => {
        container.innerHTML += `
          <div class="product-card">
            <img src="${p.image}" alt="${p.name}">
            <h3>${p.name}</h3>
            <p>–ö—Ä–µ–ø–æ—Å—Ç—å: ${p.nicotine}</p>
            <p>–ó–∞—Ç—è–∂–µ–∫: ${p.puffs}</p>
            <p>–¶–µ–Ω–∞: ‚Ç¨${p.price}</p>
            <button onclick="addToCart('${p.name}', ${p.price})">–î–æ–±–∞–≤–∏—Ç—å</button>
          </div>`;
      });
    }

    function addToCart(name, price) {
      const existing = cart.find(item => item.name === name);
      if (existing) {
        existing.qty += 1;
      } else {
        cart.push({ name, price, qty: 1 });
      }
      updateCart();
    }

    function updateCart() {
      const container = document.getElementById('cart-items');
      container.innerHTML = '';
      let total = 0;
      cart.forEach((item, i) => {
        total += item.price * item.qty;
        container.innerHTML += `
          <div class="cart-item">
            <span>${item.name} (‚Ç¨${item.price})</span>
            <div class="cart-controls">
              <button onclick="changeQty(${i}, -1)">-</button>
              ${item.qty}
              <button onclick="changeQty(${i}, 1)">+</button>
            </div>
          </div>`;
      });
      document.getElementById('cart-total').innerText = total;
    }

    function changeQty(index, delta) {
      cart[index].qty += delta;
      if (cart[index].qty <= 0) cart.splice(index, 1);
      updateCart();
    }

    function showScreen(id) {
      document.querySelectorAll('.screen').forEach(s => s.classList.remove('active'));
      document.getElementById(id).classList.add('active');
    }

    function goToCart() {
      updateCart();
      showScreen('screen-cart');
    }

    function goToChoose() {
      showScreen('screen-choose');
    }

    function goToFinish() {
      showScreen('screen-finish');
    }

    function sendToStas() {
      alert('–ó–∞–∫–∞–∑ –æ—Ç–ø—Ä–∞–≤–ª–µ–Ω –°—Ç–∞—Å—É!');
      console.log('–û—Ç–ø—Ä–∞–≤–∫–∞:', cart);
      cart = [];
      updateCart();
      goToChoose();
    }

    function goToChannel() {
      window.open("https://t.me/yourchannel", "_blank");
    }

    document.getElementById('nicotine').addEventListener('change', filterProducts);
    document.getElementById('puffs').addEventListener('change', filterProducts);
    document.getElementById('price').addEventListener('change', filterProducts);
    loadProducts();
  </script>
</body>
</html>
